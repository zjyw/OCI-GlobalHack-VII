{"version":3,"sources":["public/src/admin/manage/admins-mods.js"],"names":["define","translator","Benchpress","autocomplete","AdminsMods","init","user","$","ev","ui","socket","emit","item","uid","err","app","alertError","message","alertSuccess","val","length","parseAndTranslate","admins","members","html","prepend","on","userCard","this","parents","attr","parseInt","bootbox","confirm","remove","groupName","globalMods","addClass","children","removeClass","input","target","cid","privilege","set","member","moderatorArea"],"mappings":"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","file":"public/src/admin/manage/admins-mods.js","sourcesContent":["'use strict';\n\ndefine('admin/manage/admins-mods', ['translator', 'benchpress', 'autocomplete'], function (translator, Benchpress, autocomplete) {\n\tvar AdminsMods = {};\n\n\tAdminsMods.init = function () {\n\t\tautocomplete.user($('#admin-search'), function (ev, ui) {\n\t\t\tsocket.emit('admin.user.makeAdmins', [ui.item.user.uid], function (err) {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn app.alertError(err.message);\n\t\t\t\t}\n\t\t\t\tapp.alertSuccess('[[admin/manage/users:alerts.make-admin-success]]');\n\t\t\t\t$('#admin-search').val('');\n\n\t\t\t\tif ($('.administrator-area [data-uid=\"' + ui.item.user.uid + '\"]').length) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tapp.parseAndTranslate('admin/manage/admins-mods', 'admins.members', { admins: { members: [ui.item.user] } }, function (html) {\n\t\t\t\t\t$('.administrator-area').prepend(html);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\t$('.administrator-area').on('click', '.remove-user-icon', function () {\n\t\t\tvar userCard = $(this).parents('[data-uid]');\n\t\t\tvar uid = userCard.attr('data-uid');\n\t\t\tif (parseInt(uid, 10) === parseInt(app.user.uid, 10)) {\n\t\t\t\treturn app.alertError('[[admin/manage/users:alerts.no-remove-yourself-admin]]');\n\t\t\t}\n\t\t\tbootbox.confirm('[[admin/manage/users:alerts.confirm-remove-admin]]', function (confirm) {\n\t\t\t\tif (confirm) {\n\t\t\t\t\tsocket.emit('admin.user.removeAdmins', [uid], function (err) {\n\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\treturn app.alertError(err.message);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tapp.alertSuccess('[[admin/manage/users:alerts.remove-admin-success]]');\n\t\t\t\t\t\tuserCard.remove();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tautocomplete.user($('#global-mod-search'), function (ev, ui) {\n\t\t\tsocket.emit('admin.groups.join', {\n\t\t\t\tgroupName: 'Global Moderators',\n\t\t\t\tuid: ui.item.user.uid,\n\t\t\t}, function (err) {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn app.alertError(err.message);\n\t\t\t\t}\n\t\t\t\tapp.alertSuccess('[[admin/manage/users:alerts.make-global-mod-success]]');\n\t\t\t\t$('#global-mod-search').val('');\n\n\t\t\t\tif ($('.global-moderator-area [data-uid=\"' + ui.item.user.uid + '\"]').length) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tapp.parseAndTranslate('admin/manage/admins-mods', 'globalMods.members', { globalMods: { members: [ui.item.user] } }, function (html) {\n\t\t\t\t\t$('.global-moderator-area').prepend(html);\n\t\t\t\t\t$('#no-global-mods-warning').addClass('hidden');\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\t$('.global-moderator-area').on('click', '.remove-user-icon', function () {\n\t\t\tvar userCard = $(this).parents('[data-uid]');\n\t\t\tvar uid = userCard.attr('data-uid');\n\n\t\t\tbootbox.confirm('[[admin/manage/users:alerts.confirm-remove-global-mod]]', function (confirm) {\n\t\t\t\tif (confirm) {\n\t\t\t\t\tsocket.emit('admin.groups.leave', { uid: uid, groupName: 'Global Moderators' }, function (err) {\n\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\treturn app.alertError(err.message);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tapp.alertSuccess('[[admin/manage/users:alerts.remove-global-mod-success]]');\n\t\t\t\t\t\tuserCard.remove();\n\t\t\t\t\t\tif (!$('.global-moderator-area').children().length) {\n\t\t\t\t\t\t\t$('#no-global-mods-warning').removeClass('hidden');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\n\t\tautocomplete.user($('.moderator-search'), function (ev, ui) {\n\t\t\tvar input = $(ev.target);\n\t\t\tvar cid = $(ev.target).attr('data-cid');\n\t\t\tsocket.emit('admin.categories.setPrivilege', {\n\t\t\t\tcid: cid,\n\t\t\t\tprivilege: ['moderate'],\n\t\t\t\tset: true,\n\t\t\t\tmember: ui.item.user.uid,\n\t\t\t}, function (err) {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn app.alertError(err.message);\n\t\t\t\t}\n\t\t\t\tapp.alertSuccess('[[admin/manage/users:alerts.make-moderator-success]]');\n\t\t\t\tinput.val('');\n\n\t\t\t\tif ($('.moderator-area[data-cid=\"' + cid + '\"] [data-uid=\"' + ui.item.user.uid + '\"]').length) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tapp.parseAndTranslate('admin/manage/admins-mods', 'globalMods', { globalMods: [ui.item.user] }, function (html) {\n\t\t\t\t\t$('.moderator-area[data-cid=\"' + cid + '\"]').prepend(html);\n\t\t\t\t\t$('.no-moderator-warning[data-cid=\"' + cid + '\"]').addClass('hidden');\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\t$('.moderator-area').on('click', '.remove-user-icon', function () {\n\t\t\tvar moderatorArea = $(this).parents('[data-cid]');\n\t\t\tvar cid = moderatorArea.attr('data-cid');\n\t\t\tvar userCard = $(this).parents('[data-uid]');\n\t\t\tvar uid = userCard.attr('data-uid');\n\n\t\t\tbootbox.confirm('[[admin/manage/users:alerts.confirm-remove-moderator]]', function (confirm) {\n\t\t\t\tif (confirm) {\n\t\t\t\t\tsocket.emit('admin.categories.setPrivilege', {\n\t\t\t\t\t\tcid: cid,\n\t\t\t\t\t\tprivilege: ['moderate'],\n\t\t\t\t\t\tset: false,\n\t\t\t\t\t\tmember: uid,\n\t\t\t\t\t}, function (err) {\n\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\treturn app.alertError(err.message);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tapp.alertSuccess('[[admin/manage/users:alerts.remove-moderator-success]]');\n\t\t\t\t\t\tuserCard.remove();\n\t\t\t\t\t\tif (!moderatorArea.children().length) {\n\t\t\t\t\t\t\t$('.no-moderator-warning[data-cid=\"' + cid + '\"]').removeClass('hidden');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t};\n\n\treturn AdminsMods;\n});\n"]}