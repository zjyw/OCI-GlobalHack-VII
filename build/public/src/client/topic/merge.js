"use strict";define("forum/topic/merge",function(){var t={};var e;var o;var n={};t.init=function(){$(".category").on("click",'[component="topic/merge"]',i)};function i(){if(e){return}app.parseAndTranslate("partials/merge_topics_modal",{},function(t){e=t;$("body").append(e);o=e.find("#merge_topics_confirm");e.find(".close,#merge_topics_cancel").on("click",s);$('[component="category"]').on("click",'[component="category/topic"] a',r);a();o.on("click",function(){c(o)})})}function r(t){var e=$(this).parents('[component="category/topic"]').attr("data-tid");socket.emit("topics.getTopic",e,function(t,o){if(t){return app.alertError(t)}var i=o?o.title:"No title";if(n[e]){delete n[e]}else{n[e]=i}p();a()});t.preventDefault();t.stopPropagation();return false}function c(t){t.attr("disabled",true);var e=Object.keys(n);socket.emit("topics.merge",e,function(o){t.removeAttr("disabled");if(o){return app.alertError(o.message)}ajaxify.go("/topic/"+e[0]);s()})}function a(){var t=Object.keys(n);t.sort(function(t,e){return t-e});var o=t.map(function(t){return{tid:t,title:n[t]}});if(t.length){app.parseAndTranslate("partials/merge_topics_modal","topics",{topics:o},function(t){e.find(".topics-section").html(t)})}else{e.find(".topics-section").translateHtml("[[error:no-topics-selected]]")}}function p(){if(Object.keys(n).length){o.removeAttr("disabled")}else{o.attr("disabled",true)}}function s(){if(e){e.remove();e=null}n={};$('[component="category"]').off("click",'[component="category/topic"] a',r)}return t});
//# sourceMappingURL=public/src/client/topic/merge.js.map