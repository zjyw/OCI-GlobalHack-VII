{"version":3,"sources":["public/src/client/topic/move.js"],"names":["define","categorySelector","Move","modal","selectedCategory","init","tids","currentCid","onComplete","moveAll","socket","emit","onCategoriesLoaded","err","categories","app","alertError","message","parseModal","on","remove","find","addClass","length","translateText","onCategorySelected","onCommitClicked","callback","parseAndTranslate","html","$","category","prop","commitEl","cid","moveTopics","data","window","trigger","alertSuccess","name"],"mappings":"AAAA,aAGAA,OAAO,oBAAqB,oBAAqB,SAAUC,GAC1D,IAAIC,KACJ,IAAIC,EACJ,IAAIC,EAEJF,EAAKG,KAAO,SAAUC,EAAMC,EAAYC,GACvCN,EAAKI,KAAOA,EACZJ,EAAKK,WAAaA,EAClBL,EAAKM,WAAaA,EAClBN,EAAKO,SAAWH,EAEhBI,OAAOC,KAAK,+BAAgCC,IAG7C,SAASA,EAAmBC,EAAKC,GAChC,GAAID,EAAK,CACR,OAAOE,IAAIC,WAAWH,EAAII,SAG3BC,EAAWJ,EAAY,WACtBX,EAAMgB,GAAG,kBAAmB,WAC3BhB,EAAMiB,WAGPjB,EAAMkB,KAAK,iBAAiBC,SAAS,QAErC,GAAIpB,EAAKO,SAAYP,EAAKI,MAAQJ,EAAKI,KAAKiB,OAAS,EAAI,CACxDpB,EAAMkB,KAAK,oBAAoBG,cAAc,yBAG9CvB,EAAiBI,KAAKF,EAAMkB,KAAK,mCAAoCI,GAErEtB,EAAMkB,KAAK,uBAAuBF,GAAG,QAASO,GAE9CvB,EAAMA,MAAM,UAId,SAASe,EAAWJ,EAAYa,GAC/BZ,IAAIa,kBAAkB,8BAAgCd,WAAYA,GAAc,SAAUe,GACzF1B,EAAQ2B,EAAED,GAEVF,MAIF,SAASF,EAAmBM,GAC3B3B,EAAmB2B,EACnB5B,EAAMkB,KAAK,uBAAuBW,KAAK,WAAY,OAGpD,SAASN,IACR,IAAIO,EAAW9B,EAAMkB,KAAK,uBAE1B,IAAKY,EAASD,KAAK,aAAe5B,GAAoBA,EAAiB8B,IAAK,CAC3ED,EAASD,KAAK,WAAY,MAE1BG,KAIF,SAASA,IACR,IAAIC,GACH9B,KAAMJ,EAAKI,KACX4B,IAAK9B,EAAiB8B,IACtB3B,WAAYL,EAAKK,YAGlBuB,EAAEO,QAAQC,QAAQ,oBAAqBF,GAEvC1B,OAAOC,KAAKT,EAAKO,QAAU,iBAAmB,cAAe2B,EAAM,SAAUvB,GAC5EV,EAAMA,MAAM,QAEZ,GAAIU,EAAK,CACR,OAAOE,IAAIC,WAAWH,EAAII,SAG3BF,IAAIwB,aAAa,+BAAiCnC,EAAiBoC,KAAO,MAC1E,UAAWtC,EAAKM,aAAe,WAAY,CAC1CN,EAAKM,gBAMR,OAAON","file":"public/src/client/topic/move.js","sourcesContent":["'use strict';\n\n\ndefine('forum/topic/move', ['categorySelector'], function (categorySelector) {\n\tvar Move = {};\n\tvar modal;\n\tvar selectedCategory;\n\n\tMove.init = function (tids, currentCid, onComplete) {\n\t\tMove.tids = tids;\n\t\tMove.currentCid = currentCid;\n\t\tMove.onComplete = onComplete;\n\t\tMove.moveAll = !tids;\n\n\t\tsocket.emit('categories.getMoveCategories', onCategoriesLoaded);\n\t};\n\n\tfunction onCategoriesLoaded(err, categories) {\n\t\tif (err) {\n\t\t\treturn app.alertError(err.message);\n\t\t}\n\n\t\tparseModal(categories, function () {\n\t\t\tmodal.on('hidden.bs.modal', function () {\n\t\t\t\tmodal.remove();\n\t\t\t});\n\n\t\t\tmodal.find('#move-confirm').addClass('hide');\n\n\t\t\tif (Move.moveAll || (Move.tids && Move.tids.length > 1)) {\n\t\t\t\tmodal.find('.modal-header h3').translateText('[[topic:move_topics]]');\n\t\t\t}\n\n\t\t\tcategorySelector.init(modal.find('[component=\"category-selector\"]'), onCategorySelected);\n\n\t\t\tmodal.find('#move_thread_commit').on('click', onCommitClicked);\n\n\t\t\tmodal.modal('show');\n\t\t});\n\t}\n\n\tfunction parseModal(categories, callback) {\n\t\tapp.parseAndTranslate('partials/move_thread_modal', { categories: categories }, function (html) {\n\t\t\tmodal = $(html);\n\n\t\t\tcallback();\n\t\t});\n\t}\n\n\tfunction onCategorySelected(category) {\n\t\tselectedCategory = category;\n\t\tmodal.find('#move_thread_commit').prop('disabled', false);\n\t}\n\n\tfunction onCommitClicked() {\n\t\tvar commitEl = modal.find('#move_thread_commit');\n\n\t\tif (!commitEl.prop('disabled') && selectedCategory && selectedCategory.cid) {\n\t\t\tcommitEl.prop('disabled', true);\n\n\t\t\tmoveTopics();\n\t\t}\n\t}\n\n\tfunction moveTopics() {\n\t\tvar data = {\n\t\t\ttids: Move.tids,\n\t\t\tcid: selectedCategory.cid,\n\t\t\tcurrentCid: Move.currentCid,\n\t\t};\n\n\t\t$(window).trigger('action:topic.move', data);\n\n\t\tsocket.emit(Move.moveAll ? 'topics.moveAll' : 'topics.move', data, function (err) {\n\t\t\tmodal.modal('hide');\n\n\t\t\tif (err) {\n\t\t\t\treturn app.alertError(err.message);\n\t\t\t}\n\n\t\t\tapp.alertSuccess('[[topic:topic_move_success, ' + selectedCategory.name + ']]');\n\t\t\tif (typeof Move.onComplete === 'function') {\n\t\t\t\tMove.onComplete();\n\t\t\t}\n\t\t});\n\t}\n\n\n\treturn Move;\n});\n"]}